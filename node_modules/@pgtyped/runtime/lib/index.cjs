"use strict";var Xe=Object.create;var G=Object.defineProperty;var ex=Object.getOwnPropertyDescriptor;var xx=Object.getOwnPropertyNames;var tx=Object.getPrototypeOf,rx=Object.prototype.hasOwnProperty;var sx=(x,e)=>{for(var t in e)G(x,t,{get:e[t],enumerable:!0})},Te=(x,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of xx(e))!rx.call(x,n)&&n!==t&&G(x,n,{get:()=>e[n],enumerable:!(r=ex(e,n))||r.enumerable});return x};var N=(x,e,t)=>(t=x!=null?Xe(tx(x)):{},Te(e||!x||!x.__esModule?G(t,"default",{value:x,enumerable:!0}):t,x)),ix=x=>Te(G({},"__esModule",{value:!0}),x);var Ax={};sx(Ax,{ParameterTransform:()=>C,PreparedQuery:()=>le,TaggedQuery:()=>K,processSQLQueryIR:()=>oe,processTSQueryAST:()=>ce,sql:()=>Je});module.exports=ix(Ax);var C=(n=>(n[n.Scalar=0]="Scalar",n[n.Spread=1]="Spread",n[n.Pick=2]="Pick",n[n.PickSpread=3]="PickSpread",n))(C||{});function q(x,e){if(e.length===0)return x;e.sort((n,c)=>n.a-c.a);let t=0,r="";for(let n of e){let c=x.slice(0,n.a+t),l=x.slice(n.b+t+1,x.length);r=c+n.sub+l,t+=r.length-x.length,x=r}return r}var Z=require("antlr4ts"),ve=require("antlr4ts/tree/ParseTreeWalker.js");var Pe=require("antlr4ts/atn/ATNDeserializer.js"),ge=require("antlr4ts/Lexer.js"),Se=require("antlr4ts/atn/LexerATNSimulator.js"),Me=require("antlr4ts/VocabularyImpl.js"),Ie=N(require("antlr4ts/misc/Utils.js"),1),p=class x extends ge.Lexer{get vocabulary(){return x.VOCABULARY}constructor(e){super(e),this._interp=new Se.LexerATNSimulator(x._ATN,this)}get grammarFileName(){return"QueryLexer.g4"}get ruleNames(){return x.ruleNames}get serializedATN(){return x._serializedATN}get channelNames(){return x.channelNames}get modeNames(){return x.modeNames}static get _ATN(){return x.__ATN||(x.__ATN=new Pe.ATNDeserializer().deserialize(Ie.toCharArray(x._serializedATN))),x.__ATN}};p.ID=1;p.SINGULAR_PARAM_MARK=2;p.PLURAL_PARAM_MARK=3;p.COMMA=4;p.OB=5;p.CB=6;p.WORD=7;p.REQUIRED_MARK=8;p.SPECIAL=9;p.EOF_STATEMENT=10;p.WSL=11;p.STRING=12;p.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"];p.modeNames=["DEFAULT_MODE"];p.ruleNames=["QUOT","ID","SID","SINGULAR_PARAM_MARK","PLURAL_PARAM_MARK","COMMA","OB","CB","WORD","REQUIRED_MARK","SPECIAL","EOF_STATEMENT","WSL","STRING"];p._LITERAL_NAMES=[void 0,void 0,"'$'","'$$'","','","'('","')'",void 0,"'!'",void 0,"';'"];p._SYMBOLIC_NAMES=[void 0,"ID","SINGULAR_PARAM_MARK","PLURAL_PARAM_MARK","COMMA","OB","CB","WORD","REQUIRED_MARK","SPECIAL","EOF_STATEMENT","WSL","STRING"];p.VOCABULARY=new Me.VocabularyImpl(p._LITERAL_NAMES,p._SYMBOLIC_NAMES,[]);p._serializedATN=`\uC91D\uCABA\u058D\uAFBA\u4F53\u0607\uEA8B\uC241X\b					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r		\x07$
\f'\v\x07\x07\b\b		

9

\r

:\v\v\f\f@
\f\r\f\fA\r\rG
\rH\x07P
\fS\vW
Q\x07	\v\r\x07\b	
\v\f\x1B\r\x07C\\aac|2;C\\aac|\f$%'(,-/1<<>B]]_\`bb}\x80\v\f""^^[\x07	\v\r\x1B!\x07(	,\v.\r1358<?C\x1BFL \x07) !%	"$	#"$'%#%&&'%())**+\b+\b,-\x07&-
./\x07&/0\x07&0\f12\x07.234\x07*456\x07+679	879::8:;;<=\x07#=>@	?>@AA?ABBCD\x07=DEG	FEGHHFHIIJJK\bKLVMWNP\vONPSQRQORTSQTU
UWVMVQW	%:AHQV	\b`;var W=require("antlr4ts/atn/ATN.js"),Ne=require("antlr4ts/atn/ATNDeserializer.js"),Ce=require("antlr4ts/FailedPredicateException.js"),Le=require("antlr4ts/NoViableAltException.js"),Oe=require("antlr4ts/Parser.js"),_=require("antlr4ts/ParserRuleContext.js"),De=require("antlr4ts/atn/ParserATNSimulator.js"),E=require("antlr4ts/RecognitionException.js"),ke=require("antlr4ts/Token.js"),Ue=require("antlr4ts/VocabularyImpl.js"),be=N(require("antlr4ts/misc/Utils.js"),1),i=class x extends Oe.Parser{get vocabulary(){return x.VOCABULARY}get grammarFileName(){return"QueryParser.g4"}get ruleNames(){return x.ruleNames}get serializedATN(){return x._serializedATN}createFailedPredicateException(e,t){return new Ce.FailedPredicateException(this,e,t)}constructor(e){super(e),this._interp=new De.ParserATNSimulator(x._ATN,this)}input(){let e=new me(this._ctx,this.state);this.enterRule(e,0,x.RULE_input);let t;try{this.enterOuterAlt(e,1),this.state=22,this.query(),this.state=24,this._errHandler.sync(this),t=this._input.LA(1),t===x.EOF_STATEMENT&&(this.state=23,this.match(x.EOF_STATEMENT)),this.state=26,this.match(x.EOF)}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}query(){let e=new $(this._ctx,this.state);this.enterRule(e,2,x.RULE_query);let t;try{this.enterOuterAlt(e,1);{this.state=29,this._errHandler.sync(this),t=this._input.LA(1);do this.state=28,this.ignored(),this.state=31,this._errHandler.sync(this),t=this._input.LA(1);while(!(t&-32)&&1<<t&(1<<x.ID|1<<x.COMMA|1<<x.OB|1<<x.CB|1<<x.WORD|1<<x.REQUIRED_MARK|1<<x.SPECIAL|1<<x.STRING));for(this.state=42,this._errHandler.sync(this),t=this._input.LA(1);t===x.SINGULAR_PARAM_MARK||t===x.PLURAL_PARAM_MARK;){for(this.state=33,this.param(),this.state=37,this._errHandler.sync(this),t=this._input.LA(1);!(t&-32)&&1<<t&(1<<x.ID|1<<x.COMMA|1<<x.OB|1<<x.CB|1<<x.WORD|1<<x.REQUIRED_MARK|1<<x.SPECIAL|1<<x.STRING);)this.state=34,this.ignored(),this.state=39,this._errHandler.sync(this),t=this._input.LA(1);this.state=44,this._errHandler.sync(this),t=this._input.LA(1)}}}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}param(){let e=new L(this._ctx,this.state);this.enterRule(e,4,x.RULE_param);try{switch(this.state=49,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,4,this._ctx)){case 1:this.enterOuterAlt(e,1),this.state=45,this.pickParam();break;case 2:this.enterOuterAlt(e,2),this.state=46,this.arrayPickParam();break;case 3:this.enterOuterAlt(e,3),this.state=47,this.scalarParam();break;case 4:this.enterOuterAlt(e,4),this.state=48,this.arrayParam();break}}catch(t){if(t instanceof E.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}ignored(){let e=new O(this._ctx,this.state);this.enterRule(e,6,x.RULE_ignored);let t;try{let r;this.enterOuterAlt(e,1);{this.state=52,this._errHandler.sync(this),r=1;do{switch(r){case 1:this.state=51,t=this._input.LA(1),!(t&-32)&&1<<t&(1<<x.ID|1<<x.COMMA|1<<x.OB|1<<x.CB|1<<x.WORD|1<<x.REQUIRED_MARK|1<<x.SPECIAL|1<<x.STRING)?(this._input.LA(1)===ke.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):this._errHandler.recoverInline(this);break;default:throw new Le.NoViableAltException(this)}this.state=54,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,5,this._ctx)}while(r!==2&&r!==W.ATN.INVALID_ALT_NUMBER)}}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}scalarParam(){let e=new Y(this._ctx,this.state);this.enterRule(e,8,x.RULE_scalarParam);try{this.enterOuterAlt(e,1),this.state=56,this.match(x.SINGULAR_PARAM_MARK),this.state=57,this.scalarParamName()}catch(t){if(t instanceof E.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}pickParam(){let e=new V(this._ctx,this.state);this.enterRule(e,10,x.RULE_pickParam);let t;try{let r;this.enterOuterAlt(e,1);{for(this.state=59,this.match(x.SINGULAR_PARAM_MARK),this.state=60,this.paramName(),this.state=61,this.match(x.OB),this.state=62,this.pickKey(),this.state=67,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,6,this._ctx);r!==2&&r!==W.ATN.INVALID_ALT_NUMBER;)r===1&&(this.state=63,this.match(x.COMMA),this.state=64,this.pickKey()),this.state=69,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,6,this._ctx);this.state=71,this._errHandler.sync(this),t=this._input.LA(1),t===x.COMMA&&(this.state=70,this.match(x.COMMA)),this.state=73,this.match(x.CB)}}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}arrayPickParam(){let e=new z(this._ctx,this.state);this.enterRule(e,12,x.RULE_arrayPickParam);let t;try{let r;this.enterOuterAlt(e,1);{for(this.state=75,this.match(x.PLURAL_PARAM_MARK),this.state=76,this.paramName(),this.state=77,this.match(x.OB),this.state=78,this.pickKey(),this.state=83,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,8,this._ctx);r!==2&&r!==W.ATN.INVALID_ALT_NUMBER;)r===1&&(this.state=79,this.match(x.COMMA),this.state=80,this.pickKey()),this.state=85,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,8,this._ctx);this.state=87,this._errHandler.sync(this),t=this._input.LA(1),t===x.COMMA&&(this.state=86,this.match(x.COMMA)),this.state=89,this.match(x.CB)}}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}arrayParam(){let e=new j(this._ctx,this.state);this.enterRule(e,14,x.RULE_arrayParam);try{this.enterOuterAlt(e,1),this.state=91,this.match(x.PLURAL_PARAM_MARK),this.state=92,this.scalarParamName()}catch(t){if(t instanceof E.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}scalarParamName(){let e=new D(this._ctx,this.state);this.enterRule(e,16,x.RULE_scalarParamName);try{switch(this.enterOuterAlt(e,1),this.state=94,this.match(x.ID),this.state=96,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,10,this._ctx)){case 1:this.state=95,this.match(x.REQUIRED_MARK);break}}catch(t){if(t instanceof E.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}paramName(){let e=new k(this._ctx,this.state);this.enterRule(e,18,x.RULE_paramName);try{this.enterOuterAlt(e,1),this.state=98,this.match(x.ID)}catch(t){if(t instanceof E.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}pickKey(){let e=new g(this._ctx,this.state);this.enterRule(e,20,x.RULE_pickKey);let t;try{this.enterOuterAlt(e,1),this.state=100,this.match(x.ID),this.state=102,this._errHandler.sync(this),t=this._input.LA(1),t===x.REQUIRED_MARK&&(this.state=101,this.match(x.REQUIRED_MARK))}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}static get _ATN(){return x.__ATN||(x.__ATN=new Ne.ATNDeserializer().deserialize(be.toCharArray(x._serializedATN))),x.__ATN}};i.ID=1;i.SINGULAR_PARAM_MARK=2;i.PLURAL_PARAM_MARK=3;i.COMMA=4;i.OB=5;i.CB=6;i.WORD=7;i.REQUIRED_MARK=8;i.SPECIAL=9;i.EOF_STATEMENT=10;i.WSL=11;i.STRING=12;i.RULE_input=0;i.RULE_query=1;i.RULE_param=2;i.RULE_ignored=3;i.RULE_scalarParam=4;i.RULE_pickParam=5;i.RULE_arrayPickParam=6;i.RULE_arrayParam=7;i.RULE_scalarParamName=8;i.RULE_paramName=9;i.RULE_pickKey=10;i.ruleNames=["input","query","param","ignored","scalarParam","pickParam","arrayPickParam","arrayParam","scalarParamName","paramName","pickKey"];i._LITERAL_NAMES=[void 0,void 0,"'$'","'$$'","','","'('","')'",void 0,"'!'",void 0,"';'"];i._SYMBOLIC_NAMES=[void 0,"ID","SINGULAR_PARAM_MARK","PLURAL_PARAM_MARK","COMMA","OB","CB","WORD","REQUIRED_MARK","SPECIAL","EOF_STATEMENT","WSL","STRING"];i.VOCABULARY=new Ue.VocabularyImpl(i._LITERAL_NAMES,i._SYMBOLIC_NAMES,[]);i._serializedATN=`\uC91D\uCABA\u058D\uAFBA\u4F53\u0607\uEA8B\uC241k					\x07	\x07\b	\b			
	
\v	\v\f	\f\x1B
 
\r!\x07&
\f)\v\x07+
\f.\v4
7
\r8\x07\x07\x07\x07\x07\x07\x07\x07D
\x07\f\x07\x07G\v\x07\x07\x07J
\x07\x07\x07\b\b\b\b\b\b\x07\bT
\b\f\b\bW\v\b\b\bZ
\b\b\b			


c

\v\v\f\f\fi
\f\f\r\b
\f\vm3\b6
:\f=M]\`df\x1B\x07\f\x1B\x1B\x07 \b !!!"",#'$&\b%$&)'%'((+)'*#+.,*,--.,/4\f\x0704\b14
24	3/3031324\x0757	657886899	:;\x07;<
<\v=>\x07>?\v?@\x07\x07@E\fAB\x07BD\fCADGECEFFIGEHJ\x07IHIJJKKL\x07\bL\rMN\x07NO\vOP\x07\x07PU\fQR\x07RT\fSQTWUSUVVYWUXZ\x07YXYZZ[[\\\x07\b\\]^\x07^_
_\`b\x07ac\x07
babccde\x07efh\x07gi\x07
hghii!',38EIUYbh`;var me=class extends _.ParserRuleContext{query(){return this.getRuleContext(0,$)}EOF(){return this.getToken(i.EOF,0)}EOF_STATEMENT(){return this.tryGetToken(i.EOF_STATEMENT,0)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_input}enterRule(e){e.enterInput&&e.enterInput(this)}exitRule(e){e.exitInput&&e.exitInput(this)}accept(e){return e.visitInput?e.visitInput(this):e.visitChildren(this)}},$=class extends _.ParserRuleContext{ignored(e){return e===void 0?this.getRuleContexts(O):this.getRuleContext(e,O)}param(e){return e===void 0?this.getRuleContexts(L):this.getRuleContext(e,L)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_query}enterRule(e){e.enterQuery&&e.enterQuery(this)}exitRule(e){e.exitQuery&&e.exitQuery(this)}accept(e){return e.visitQuery?e.visitQuery(this):e.visitChildren(this)}},L=class extends _.ParserRuleContext{pickParam(){return this.tryGetRuleContext(0,V)}arrayPickParam(){return this.tryGetRuleContext(0,z)}scalarParam(){return this.tryGetRuleContext(0,Y)}arrayParam(){return this.tryGetRuleContext(0,j)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_param}enterRule(e){e.enterParam&&e.enterParam(this)}exitRule(e){e.exitParam&&e.exitParam(this)}accept(e){return e.visitParam?e.visitParam(this):e.visitChildren(this)}},O=class extends _.ParserRuleContext{ID(e){return e===void 0?this.getTokens(i.ID):this.getToken(i.ID,e)}WORD(e){return e===void 0?this.getTokens(i.WORD):this.getToken(i.WORD,e)}STRING(e){return e===void 0?this.getTokens(i.STRING):this.getToken(i.STRING,e)}COMMA(e){return e===void 0?this.getTokens(i.COMMA):this.getToken(i.COMMA,e)}OB(e){return e===void 0?this.getTokens(i.OB):this.getToken(i.OB,e)}CB(e){return e===void 0?this.getTokens(i.CB):this.getToken(i.CB,e)}SPECIAL(e){return e===void 0?this.getTokens(i.SPECIAL):this.getToken(i.SPECIAL,e)}REQUIRED_MARK(e){return e===void 0?this.getTokens(i.REQUIRED_MARK):this.getToken(i.REQUIRED_MARK,e)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_ignored}enterRule(e){e.enterIgnored&&e.enterIgnored(this)}exitRule(e){e.exitIgnored&&e.exitIgnored(this)}accept(e){return e.visitIgnored?e.visitIgnored(this):e.visitChildren(this)}},Y=class extends _.ParserRuleContext{SINGULAR_PARAM_MARK(){return this.getToken(i.SINGULAR_PARAM_MARK,0)}scalarParamName(){return this.getRuleContext(0,D)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_scalarParam}enterRule(e){e.enterScalarParam&&e.enterScalarParam(this)}exitRule(e){e.exitScalarParam&&e.exitScalarParam(this)}accept(e){return e.visitScalarParam?e.visitScalarParam(this):e.visitChildren(this)}},V=class extends _.ParserRuleContext{SINGULAR_PARAM_MARK(){return this.getToken(i.SINGULAR_PARAM_MARK,0)}paramName(){return this.getRuleContext(0,k)}OB(){return this.getToken(i.OB,0)}pickKey(e){return e===void 0?this.getRuleContexts(g):this.getRuleContext(e,g)}CB(){return this.getToken(i.CB,0)}COMMA(e){return e===void 0?this.getTokens(i.COMMA):this.getToken(i.COMMA,e)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_pickParam}enterRule(e){e.enterPickParam&&e.enterPickParam(this)}exitRule(e){e.exitPickParam&&e.exitPickParam(this)}accept(e){return e.visitPickParam?e.visitPickParam(this):e.visitChildren(this)}},z=class extends _.ParserRuleContext{PLURAL_PARAM_MARK(){return this.getToken(i.PLURAL_PARAM_MARK,0)}paramName(){return this.getRuleContext(0,k)}OB(){return this.getToken(i.OB,0)}pickKey(e){return e===void 0?this.getRuleContexts(g):this.getRuleContext(e,g)}CB(){return this.getToken(i.CB,0)}COMMA(e){return e===void 0?this.getTokens(i.COMMA):this.getToken(i.COMMA,e)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_arrayPickParam}enterRule(e){e.enterArrayPickParam&&e.enterArrayPickParam(this)}exitRule(e){e.exitArrayPickParam&&e.exitArrayPickParam(this)}accept(e){return e.visitArrayPickParam?e.visitArrayPickParam(this):e.visitChildren(this)}},j=class extends _.ParserRuleContext{PLURAL_PARAM_MARK(){return this.getToken(i.PLURAL_PARAM_MARK,0)}scalarParamName(){return this.getRuleContext(0,D)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_arrayParam}enterRule(e){e.enterArrayParam&&e.enterArrayParam(this)}exitRule(e){e.exitArrayParam&&e.exitArrayParam(this)}accept(e){return e.visitArrayParam?e.visitArrayParam(this):e.visitChildren(this)}},D=class extends _.ParserRuleContext{ID(){return this.getToken(i.ID,0)}REQUIRED_MARK(){return this.tryGetToken(i.REQUIRED_MARK,0)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_scalarParamName}enterRule(e){e.enterScalarParamName&&e.enterScalarParamName(this)}exitRule(e){e.exitScalarParamName&&e.exitScalarParamName(this)}accept(e){return e.visitScalarParamName?e.visitScalarParamName(this):e.visitChildren(this)}},k=class extends _.ParserRuleContext{ID(){return this.getToken(i.ID,0)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_paramName}enterRule(e){e.enterParamName&&e.enterParamName(this)}exitRule(e){e.exitParamName&&e.exitParamName(this)}accept(e){return e.visitParamName?e.visitParamName(this):e.visitChildren(this)}},g=class extends _.ParserRuleContext{ID(){return this.getToken(i.ID,0)}REQUIRED_MARK(){return this.tryGetToken(i.REQUIRED_MARK,0)}constructor(e,t){super(e,t)}get ruleIndex(){return i.RULE_pickKey}enterRule(e){e.enterPickKey&&e.enterPickKey(this)}exitRule(e){e.exitPickKey&&e.exitPickKey(this)}accept(e){return e.visitPickKey?e.visitPickKey(this):e.visitChildren(this)}};var nx=N(require("chalk"),1),de;(function(x){x[x.ParamNeverUsed=0]="ParamNeverUsed"})(de||(de={}));var pe;(function(x){x[x.ParseError=0]="ParseError"})(pe||(pe={}));var J;(function(x){x[x.Info=0]="Info",x[x.Warning=1]="Warning",x[x.Error=2]="Error"})(J||(J={}));var U=class{constructor(){this.parseEvents=[]}logEvent(e){this.parseEvents.push(e)}syntaxError(e,t,r,n,c,l){this.logEvent({type:J.Error,critical:!0,message:{type:pe.ParseError,text:`Parse error: ${c}`},location:{a:t==null?void 0:t.startIndex,b:t==null?void 0:t.stopIndex,line:r,col:n}})}};var Be=require("antlr4ts/misc/index.js"),y;(function(x){x.Scalar="scalar",x.Object="object",x.ScalarArray="scalar_array",x.ObjectArray="object_array"})(y||(y={}));function ax(x){if(!x)throw new Error("Assertion Failed")}var Re=class{constructor(e,t){this.query={},this.currentParam={},this.currentSelection={},this.query.name=e,this.logger=t}enterQuery(e){let{inputStream:t}=e.start,r=e.stop.stopIndex,n=new Be.Interval(0,r),c=t.getText(n);this.query={name:this.query.name,text:c,params:[]}}enterParamName(e){this.currentParam={name:e.text,selection:void 0}}enterScalarParamName(e){let t=!!e.REQUIRED_MARK(),r=e.ID().text;this.currentParam={name:r,required:t}}exitParam(e){let t={a:e.start.startIndex,b:e.stop.stopIndex,line:e.start.line,col:e.start.charPositionInLine};this.currentParam.location=t,this.currentParam.selection=this.currentSelection,this.query.params.push(this.currentParam),this.currentSelection={},this.currentParam={}}enterScalarParam(){this.currentSelection={type:y.Scalar}}enterPickParam(){this.currentSelection={type:y.Object,keys:[]}}enterArrayPickParam(){this.currentSelection={type:y.ObjectArray,keys:[]}}enterArrayParam(){this.currentSelection={type:y.ScalarArray}}enterPickKey(e){ax("keys"in this.currentSelection);let t=!!e.REQUIRED_MARK(),r=e.ID().text;this.currentSelection.keys.push({name:r,required:t})}};function hx(x,e="query"){let t=new U,r=Z.CharStreams.fromString(x),n=new p(r);n.removeErrorListeners(),n.addErrorListener(t);let c=new Z.CommonTokenStream(n),l=new i(c);l.removeErrorListeners(),l.addErrorListener(t);let h=l.input(),a=new Re(e,t);return ve.ParseTreeWalker.DEFAULT.walk(a,h),{query:a.query,events:t.parseEvents}}var Ae=hx;var ze=require("antlr4ts"),cx=require("antlr4ts/tree/ParseTreeWalker.js");var Qe=require("antlr4ts/atn/ATNDeserializer.js"),Fe=require("antlr4ts/Lexer.js"),we=require("antlr4ts/atn/LexerATNSimulator.js"),He=require("antlr4ts/VocabularyImpl.js"),Ke=N(require("antlr4ts/misc/Utils.js"),1),o=class x extends Fe.Lexer{get vocabulary(){return x.VOCABULARY}constructor(e){super(e),this._interp=new we.LexerATNSimulator(x._ATN,this)}get grammarFileName(){return"SQLLexer.g4"}get ruleNames(){return x.ruleNames}get serializedATN(){return x._serializedATN}get channelNames(){return x.channelNames}get modeNames(){return x.modeNames}static get _ATN(){return x.__ATN||(x.__ATN=new Qe.ATNDeserializer().deserialize(Ke.toCharArray(x._serializedATN))),x.__ATN}};o.ID=1;o.LINE_COMMENT=2;o.OPEN_COMMENT=3;o.S_REQUIRED_MARK=4;o.WORD=5;o.EOF_STATEMENT=6;o.WSL=7;o.STRING=8;o.DOLLAR_STRING=9;o.PARAM_MARK=10;o.WS=11;o.TRANSFORM_ARROW=12;o.SPREAD=13;o.NAME_TAG=14;o.TYPE_TAG=15;o.OB=16;o.CB=17;o.COMMA=18;o.C_REQUIRED_MARK=19;o.ANY=20;o.CLOSE_COMMENT=21;o.DOLLAR=22;o.CAST=23;o.COMMENT=1;o.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"];o.modeNames=["DEFAULT_MODE","COMMENT"];o.ruleNames=["QUOT","ID","LINE_COMMENT","OPEN_COMMENT","SID","S_REQUIRED_MARK","WORD","SPECIAL","DOLLAR","EOF_STATEMENT","WSL","STRING","DOLLAR_STRING","PARAM_MARK","CAST","CID","WS","TRANSFORM_ARROW","SPREAD","NAME_TAG","TYPE_TAG","OB","CB","COMMA","C_REQUIRED_MARK","ANY","CLOSE_COMMENT"];o._LITERAL_NAMES=[void 0,void 0,void 0,"'/*'",void 0,void 0,"';'",void 0,void 0,void 0,"':'",void 0,"'->'","'...'","'@name'","'@param'","'('","')'","','",void 0,void 0,"'*/'","'$'","'::'"];o._SYMBOLIC_NAMES=[void 0,"ID","LINE_COMMENT","OPEN_COMMENT","S_REQUIRED_MARK","WORD","EOF_STATEMENT","WSL","STRING","DOLLAR_STRING","PARAM_MARK","WS","TRANSFORM_ARROW","SPREAD","NAME_TAG","TYPE_TAG","OB","CB","COMMA","C_REQUIRED_MARK","ANY","CLOSE_COMMENT","DOLLAR","CAST"];o.VOCABULARY=new He.VocabularyImpl(o._LITERAL_NAMES,o._SYMBOLIC_NAMES,[]);o._serializedATN=`\uC91D\uCABA\u058D\uAFBA\u4F53\u0607\uEA8B\uC241\xCA\b\b					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r													\x1B	\x1B	\x07?
\fB\v\x07H
\fK\vN
\x07\x07\b\b^
\b\r\b\b_		c
	\r		d		



\v\v\f\fp
\f\r\f\fq\f\f\r\r\r\x07\ry
\r\f\r\r|\v\r\r\r\r\x80
\r\x84
\x07\x88
\f\x8B\v\x8F
\x9F
\r\xA0\x1B\x1B\xC2
\x1B\r\x1B\x1B\xC3z\xC3\b
\f\x07\b	
\v\f "$\r&(*,.02468\bC\\aac|2;C\\aac|\f\f
$%'(*1>B]]_\`bb}\x80\v\f""^^\xD3\b
\f "$&(*,.02468:<\bC
Q\fVZ]bhlou\x81\x92 \x94"\x99$\x9E&\xA4(\xA7*\xAB,\xB1.\xB80\xBA2\xBC4\xBE6\xC18\xC5:;\x07);<@	=?	>=?B@>@AA\x07B@CD\x07/DE\x07/EIFH
GFHKIGIJJMKILN\x07MLMNNOOP\x07\fP	QR\x071RS\x07,STTU\bU\vVWWXXY\bY\rZ[\x07#[\\^	]\\^__]_\`\`ac	bacddbdeeffg\b	ghi\x07&ijjk\b
klm\x07=mnp	onpqqoqrrsst\b\ftu\x7Fv\x80wy\vxwy|z{zx{}|z}~
\x07~\x80\x7Fv\x7Fz\x80\x1B\x81\x83
\x82\x84\b\x83\x82\x83\x84\x84\x85\x85\x89
\x86\x88\v\x87\x86\x88\x8B\x89\x87\x89\x8A\x8A\x8C\x8B\x89\x8C\x8E
\x8D\x8F\b\x8E\x8D\x8E\x8F\x8F\x90\x90\x91
\x91\x92\x93\x07<\x93\x94\x95\x07<\x95\x96\x07<\x96\x97\x97\x98\b\x98!\x99\x9A\x9A\x9B\x9B\x9C\b\x9C#\x9D\x9F	\x9E\x9D\x9F\xA0\xA0\x9E\xA0\xA1\xA1\xA2\xA2\xA3\b\xA3%\xA4\xA5\x07/\xA5\xA6\x07@\xA6'\xA7\xA8\x070\xA8\xA9\x070\xA9\xAA\x070\xAA)\xAB\xAC\x07B\xAC\xAD\x07p\xAD\xAE\x07c\xAE\xAF\x07o\xAF\xB0\x07g\xB0+\xB1\xB2\x07B\xB2\xB3\x07r\xB3\xB4\x07c\xB4\xB5\x07t\xB5\xB6\x07c\xB6\xB7\x07o\xB7-\xB8\xB9\x07*\xB9/\xBA\xBB\x07+\xBB1\xBC\xBD\x07.\xBD3\xBE\xBF\x07#\xBF5\xC0\xC2\v\xC1\xC0\xC2\xC3\xC3\xC4\xC3\xC1\xC47\xC5\xC6\x07,\xC6\xC7\x071\xC7\xC8\xC8\xC9\b\xC99@IM_dqz\x7F\x83\x89\x8E\xA0\xC3\x07		\x07\b`;var fe=require("antlr4ts/atn/ATN.js"),Ge=require("antlr4ts/atn/ATNDeserializer.js"),qe=require("antlr4ts/FailedPredicateException.js"),We=require("antlr4ts/Parser.js"),A=require("antlr4ts/ParserRuleContext.js"),$e=require("antlr4ts/atn/ParserATNSimulator.js"),R=require("antlr4ts/RecognitionException.js"),Ee=require("antlr4ts/Token.js"),Ye=require("antlr4ts/VocabularyImpl.js"),Ve=N(require("antlr4ts/misc/Utils.js"),1),s=class x extends We.Parser{get vocabulary(){return x.VOCABULARY}get grammarFileName(){return"SQLParser.g4"}get ruleNames(){return x.ruleNames}get serializedATN(){return x._serializedATN}createFailedPredicateException(e,t){return new qe.FailedPredicateException(this,e,t)}constructor(e){super(e),this._interp=new $e.ParserATNSimulator(x._ATN,this)}input(){let e=new _e(this._ctx,this.state);this.enterRule(e,0,x.RULE_input);let t;try{let r;this.enterOuterAlt(e,1);{this.state=47,this._errHandler.sync(this),t=this._input.LA(1);do{{for(this.state=43,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,0,this._ctx);r!==2&&r!==fe.ATN.INVALID_ALT_NUMBER;)r===1&&(this.state=40,this.ignoredComment()),this.state=45,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,0,this._ctx);this.state=46,this.query()}this.state=49,this._errHandler.sync(this),t=this._input.LA(1)}while(t===x.OPEN_COMMENT);this.state=51,this.match(x.EOF)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}query(){let e=new b(this._ctx,this.state);this.enterRule(e,2,x.RULE_query);try{this.enterOuterAlt(e,1),this.state=53,this.queryDef(),this.state=54,this.statement()}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}queryDef(){let e=new X(this._ctx,this.state);this.enterRule(e,4,x.RULE_queryDef);let t;try{this.enterOuterAlt(e,1);{for(this.state=56,this.match(x.OPEN_COMMENT),this.state=57,this.nameTag(),this.state=61,this._errHandler.sync(this),t=this._input.LA(1);t===x.TYPE_TAG;)this.state=58,this.paramTag(),this.state=63,this._errHandler.sync(this),t=this._input.LA(1);this.state=64,this.match(x.CLOSE_COMMENT)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}ignoredComment(){let e=new S(this._ctx,this.state);this.enterRule(e,6,x.RULE_ignoredComment);let t;try{this.enterOuterAlt(e,1);{for(this.state=66,this.match(x.OPEN_COMMENT),this.state=70,this._errHandler.sync(this),t=this._input.LA(1);!(t&-32)&&1<<t&(1<<x.ID|1<<x.LINE_COMMENT|1<<x.OPEN_COMMENT|1<<x.S_REQUIRED_MARK|1<<x.WORD|1<<x.EOF_STATEMENT|1<<x.WSL|1<<x.STRING|1<<x.DOLLAR_STRING|1<<x.PARAM_MARK|1<<x.WS|1<<x.TRANSFORM_ARROW|1<<x.SPREAD|1<<x.NAME_TAG|1<<x.TYPE_TAG|1<<x.OB|1<<x.CB|1<<x.COMMA|1<<x.C_REQUIRED_MARK|1<<x.ANY|1<<x.DOLLAR|1<<x.CAST);)this.state=67,t=this._input.LA(1),t<=0||t===x.CLOSE_COMMENT?this._errHandler.recoverInline(this):(this._input.LA(1)===Ee.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()),this.state=72,this._errHandler.sync(this),t=this._input.LA(1);this.state=73,this.match(x.CLOSE_COMMENT)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}statement(){let e=new ee(this._ctx,this.state);this.enterRule(e,8,x.RULE_statement);try{this.enterOuterAlt(e,1),this.state=75,this.statementBody(),this.state=76,this.match(x.EOF_STATEMENT)}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}statementBody(){let e=new xe(this._ctx,this.state);this.enterRule(e,10,x.RULE_statementBody);let t;try{for(this.enterOuterAlt(e,1),this.state=85,this._errHandler.sync(this),t=this._input.LA(1);!(t&-32)&&1<<t&(1<<x.ID|1<<x.LINE_COMMENT|1<<x.OPEN_COMMENT|1<<x.S_REQUIRED_MARK|1<<x.WORD|1<<x.STRING|1<<x.DOLLAR_STRING|1<<x.PARAM_MARK);){switch(this.state=83,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,4,this._ctx)){case 1:this.state=78,this.match(x.LINE_COMMENT);break;case 2:this.state=79,this.ignoredComment();break;case 3:this.state=80,this.param();break;case 4:this.state=81,this.word();break;case 5:this.state=82,this.range();break}this.state=87,this._errHandler.sync(this),t=this._input.LA(1)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}word(){let e=new I(this._ctx,this.state);this.enterRule(e,12,x.RULE_word);let t;try{this.enterOuterAlt(e,1),this.state=88,t=this._input.LA(1),!(t&-32)&&1<<t&(1<<x.ID|1<<x.S_REQUIRED_MARK|1<<x.WORD|1<<x.STRING|1<<x.DOLLAR_STRING)?(this._input.LA(1)===Ee.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):this._errHandler.recoverInline(this)}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}range(){let e=new v(this._ctx,this.state);this.enterRule(e,14,x.RULE_range);try{this.enterOuterAlt(e,1),this.state=90,this.match(x.PARAM_MARK),this.state=91,this.word()}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}param(){let e=new B(this._ctx,this.state);this.enterRule(e,16,x.RULE_param);try{this.enterOuterAlt(e,1),this.state=93,this.match(x.PARAM_MARK),this.state=94,this.paramId()}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}paramId(){let e=new te(this._ctx,this.state);this.enterRule(e,18,x.RULE_paramId);try{switch(this.enterOuterAlt(e,1),this.state=96,this.match(x.ID),this.state=98,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,6,this._ctx)){case 1:this.state=97,this.match(x.S_REQUIRED_MARK);break}}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}nameTag(){let e=new re(this._ctx,this.state);this.enterRule(e,20,x.RULE_nameTag);try{this.enterOuterAlt(e,1),this.state=100,this.match(x.NAME_TAG),this.state=101,this.queryName()}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}paramTag(){let e=new Q(this._ctx,this.state);this.enterRule(e,22,x.RULE_paramTag);try{this.enterOuterAlt(e,1),this.state=103,this.match(x.TYPE_TAG),this.state=104,this.paramName(),this.state=105,this.paramTransform()}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}paramTransform(){let e=new se(this._ctx,this.state);this.enterRule(e,24,x.RULE_paramTransform);try{this.enterOuterAlt(e,1),this.state=107,this.match(x.TRANSFORM_ARROW),this.state=108,this.transformRule()}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}transformRule(){let e=new ie(this._ctx,this.state);this.enterRule(e,26,x.RULE_transformRule);try{switch(this.state=113,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,7,this._ctx)){case 1:this.enterOuterAlt(e,1),this.state=110,this.spreadTransform();break;case 2:this.enterOuterAlt(e,2),this.state=111,this.pickTransform();break;case 3:this.enterOuterAlt(e,3),this.state=112,this.spreadPickTransform();break}}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}spreadTransform(){let e=new ne(this._ctx,this.state);this.enterRule(e,28,x.RULE_spreadTransform);try{this.enterOuterAlt(e,1),this.state=115,this.match(x.OB),this.state=116,this.match(x.SPREAD),this.state=117,this.match(x.CB)}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}pickTransform(){let e=new F(this._ctx,this.state);this.enterRule(e,30,x.RULE_pickTransform);let t;try{let r;this.enterOuterAlt(e,1);{for(this.state=119,this.match(x.OB),this.state=120,this.key(),this.state=125,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,8,this._ctx);r!==2&&r!==fe.ATN.INVALID_ALT_NUMBER;)r===1&&(this.state=121,this.match(x.COMMA),this.state=122,this.key()),this.state=127,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,8,this._ctx);this.state=129,this._errHandler.sync(this),t=this._input.LA(1),t===x.COMMA&&(this.state=128,this.match(x.COMMA)),this.state=131,this.match(x.CB)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}spreadPickTransform(){let e=new ae(this._ctx,this.state);this.enterRule(e,32,x.RULE_spreadPickTransform);try{this.enterOuterAlt(e,1),this.state=133,this.match(x.OB),this.state=134,this.pickTransform(),this.state=135,this.match(x.SPREAD),this.state=136,this.match(x.CB)}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}key(){let e=new w(this._ctx,this.state);this.enterRule(e,34,x.RULE_key);let t;try{this.enterOuterAlt(e,1),this.state=138,this.match(x.ID),this.state=140,this._errHandler.sync(this),t=this._input.LA(1),t===x.C_REQUIRED_MARK&&(this.state=139,this.match(x.C_REQUIRED_MARK))}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}queryName(){let e=new he(this._ctx,this.state);this.enterRule(e,36,x.RULE_queryName);try{this.enterOuterAlt(e,1),this.state=142,this.match(x.ID)}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}paramName(){let e=new ue(this._ctx,this.state);this.enterRule(e,38,x.RULE_paramName);try{this.enterOuterAlt(e,1),this.state=144,this.match(x.ID)}catch(t){if(t instanceof R.RecognitionException)e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t);else throw t}finally{this.exitRule()}return e}static get _ATN(){return x.__ATN||(x.__ATN=new Ge.ATNDeserializer().deserialize(Ve.toCharArray(x._serializedATN))),x.__ATN}};s.ID=1;s.LINE_COMMENT=2;s.OPEN_COMMENT=3;s.S_REQUIRED_MARK=4;s.WORD=5;s.EOF_STATEMENT=6;s.WSL=7;s.STRING=8;s.DOLLAR_STRING=9;s.PARAM_MARK=10;s.WS=11;s.TRANSFORM_ARROW=12;s.SPREAD=13;s.NAME_TAG=14;s.TYPE_TAG=15;s.OB=16;s.CB=17;s.COMMA=18;s.C_REQUIRED_MARK=19;s.ANY=20;s.CLOSE_COMMENT=21;s.DOLLAR=22;s.CAST=23;s.RULE_input=0;s.RULE_query=1;s.RULE_queryDef=2;s.RULE_ignoredComment=3;s.RULE_statement=4;s.RULE_statementBody=5;s.RULE_word=6;s.RULE_range=7;s.RULE_param=8;s.RULE_paramId=9;s.RULE_nameTag=10;s.RULE_paramTag=11;s.RULE_paramTransform=12;s.RULE_transformRule=13;s.RULE_spreadTransform=14;s.RULE_pickTransform=15;s.RULE_spreadPickTransform=16;s.RULE_key=17;s.RULE_queryName=18;s.RULE_paramName=19;s.ruleNames=["input","query","queryDef","ignoredComment","statement","statementBody","word","range","param","paramId","nameTag","paramTag","paramTransform","transformRule","spreadTransform","pickTransform","spreadPickTransform","key","queryName","paramName"];s._LITERAL_NAMES=[void 0,void 0,void 0,"'/*'",void 0,void 0,"';'",void 0,void 0,void 0,"':'",void 0,"'->'","'...'","'@name'","'@param'","'('","')'","','",void 0,void 0,"'*/'","'$'","'::'"];s._SYMBOLIC_NAMES=[void 0,"ID","LINE_COMMENT","OPEN_COMMENT","S_REQUIRED_MARK","WORD","EOF_STATEMENT","WSL","STRING","DOLLAR_STRING","PARAM_MARK","WS","TRANSFORM_ARROW","SPREAD","NAME_TAG","TYPE_TAG","OB","CB","COMMA","C_REQUIRED_MARK","ANY","CLOSE_COMMENT","DOLLAR","CAST"];s.VOCABULARY=new Ye.VocabularyImpl(s._LITERAL_NAMES,s._SYMBOLIC_NAMES,[]);s._serializedATN=`\uC91D\uCABA\u058D\uAFBA\u4F53\u0607\uEA8B\uC241\x95					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r								\x07,
\f/\v2
\r3\x07>
\fA\v\x07G
\fJ\v\x07\x07\x07\x07\x07\x07\x07V
\x07\f\x07\x07Y\v\x07\b\b			


\v\v\ve
\v\f\f\f\r\r\r\rt
\x07~
\f\x81\v\x84
\x8F
\b
\f "$&(\x07
\v\x8F17:\bD
M\fWZ\\_bfimsu y"\x87$\x8C&\x90(\x92*,\b+*,/-+-..0/-021-2331344556\x0767889
9:;\x07;?\f<>\r=<>A?=?@@BA?BC\x07C\x07DH\x07EG
FEGJHFHIIKJHKL\x07L	MN\f\x07NO\x07\bO\vPV\x07QV\bRV
SV\bTV	UPUQURUSUTVYWUWXX\rYWZ[	[\\]\x07\f]^\b^_\`\x07\f\`a\vabd\x07ce\x07dcdeefg\x07gh&hij\x07jk(kllmn\x07noo\x1Bptqt rt"spsqsrtuv\x07vw\x07wx\x07xyz\x07z\x7F${|\x07|~$}{~\x81\x7F}\x7F\x80\x80\x83\x81\x7F\x82\x84\x07\x83\x82\x83\x84\x84\x85\x85\x86\x07\x86!\x87\x88\x07\x88\x89 \x89\x8A\x07\x8A\x8B\x07\x8B#\x8C\x8E\x07\x8D\x8F\x07\x8E\x8D\x8E\x8F\x8F%\x90\x91\x07\x91'\x92\x93\x07\x93)\r-3?HUWds\x7F\x83\x8E`;var _e=class extends A.ParserRuleContext{EOF(){return this.getToken(s.EOF,0)}query(e){return e===void 0?this.getRuleContexts(b):this.getRuleContext(e,b)}ignoredComment(e){return e===void 0?this.getRuleContexts(S):this.getRuleContext(e,S)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_input}enterRule(e){e.enterInput&&e.enterInput(this)}exitRule(e){e.exitInput&&e.exitInput(this)}accept(e){return e.visitInput?e.visitInput(this):e.visitChildren(this)}},b=class extends A.ParserRuleContext{queryDef(){return this.getRuleContext(0,X)}statement(){return this.getRuleContext(0,ee)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_query}enterRule(e){e.enterQuery&&e.enterQuery(this)}exitRule(e){e.exitQuery&&e.exitQuery(this)}accept(e){return e.visitQuery?e.visitQuery(this):e.visitChildren(this)}},X=class extends A.ParserRuleContext{OPEN_COMMENT(){return this.getToken(s.OPEN_COMMENT,0)}nameTag(){return this.getRuleContext(0,re)}CLOSE_COMMENT(){return this.getToken(s.CLOSE_COMMENT,0)}paramTag(e){return e===void 0?this.getRuleContexts(Q):this.getRuleContext(e,Q)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_queryDef}enterRule(e){e.enterQueryDef&&e.enterQueryDef(this)}exitRule(e){e.exitQueryDef&&e.exitQueryDef(this)}accept(e){return e.visitQueryDef?e.visitQueryDef(this):e.visitChildren(this)}},S=class extends A.ParserRuleContext{OPEN_COMMENT(){return this.getToken(s.OPEN_COMMENT,0)}CLOSE_COMMENT(e){return e===void 0?this.getTokens(s.CLOSE_COMMENT):this.getToken(s.CLOSE_COMMENT,e)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_ignoredComment}enterRule(e){e.enterIgnoredComment&&e.enterIgnoredComment(this)}exitRule(e){e.exitIgnoredComment&&e.exitIgnoredComment(this)}accept(e){return e.visitIgnoredComment?e.visitIgnoredComment(this):e.visitChildren(this)}},ee=class extends A.ParserRuleContext{statementBody(){return this.getRuleContext(0,xe)}EOF_STATEMENT(){return this.getToken(s.EOF_STATEMENT,0)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_statement}enterRule(e){e.enterStatement&&e.enterStatement(this)}exitRule(e){e.exitStatement&&e.exitStatement(this)}accept(e){return e.visitStatement?e.visitStatement(this):e.visitChildren(this)}},xe=class extends A.ParserRuleContext{LINE_COMMENT(e){return e===void 0?this.getTokens(s.LINE_COMMENT):this.getToken(s.LINE_COMMENT,e)}ignoredComment(e){return e===void 0?this.getRuleContexts(S):this.getRuleContext(e,S)}param(e){return e===void 0?this.getRuleContexts(B):this.getRuleContext(e,B)}word(e){return e===void 0?this.getRuleContexts(I):this.getRuleContext(e,I)}range(e){return e===void 0?this.getRuleContexts(v):this.getRuleContext(e,v)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_statementBody}enterRule(e){e.enterStatementBody&&e.enterStatementBody(this)}exitRule(e){e.exitStatementBody&&e.exitStatementBody(this)}accept(e){return e.visitStatementBody?e.visitStatementBody(this):e.visitChildren(this)}},I=class extends A.ParserRuleContext{WORD(){return this.tryGetToken(s.WORD,0)}ID(){return this.tryGetToken(s.ID,0)}STRING(){return this.tryGetToken(s.STRING,0)}S_REQUIRED_MARK(){return this.tryGetToken(s.S_REQUIRED_MARK,0)}DOLLAR_STRING(){return this.tryGetToken(s.DOLLAR_STRING,0)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_word}enterRule(e){e.enterWord&&e.enterWord(this)}exitRule(e){e.exitWord&&e.exitWord(this)}accept(e){return e.visitWord?e.visitWord(this):e.visitChildren(this)}},v=class extends A.ParserRuleContext{PARAM_MARK(){return this.getToken(s.PARAM_MARK,0)}word(){return this.getRuleContext(0,I)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_range}enterRule(e){e.enterRange&&e.enterRange(this)}exitRule(e){e.exitRange&&e.exitRange(this)}accept(e){return e.visitRange?e.visitRange(this):e.visitChildren(this)}},B=class extends A.ParserRuleContext{PARAM_MARK(){return this.getToken(s.PARAM_MARK,0)}paramId(){return this.getRuleContext(0,te)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_param}enterRule(e){e.enterParam&&e.enterParam(this)}exitRule(e){e.exitParam&&e.exitParam(this)}accept(e){return e.visitParam?e.visitParam(this):e.visitChildren(this)}},te=class extends A.ParserRuleContext{ID(){return this.getToken(s.ID,0)}S_REQUIRED_MARK(){return this.tryGetToken(s.S_REQUIRED_MARK,0)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_paramId}enterRule(e){e.enterParamId&&e.enterParamId(this)}exitRule(e){e.exitParamId&&e.exitParamId(this)}accept(e){return e.visitParamId?e.visitParamId(this):e.visitChildren(this)}},re=class extends A.ParserRuleContext{NAME_TAG(){return this.getToken(s.NAME_TAG,0)}queryName(){return this.getRuleContext(0,he)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_nameTag}enterRule(e){e.enterNameTag&&e.enterNameTag(this)}exitRule(e){e.exitNameTag&&e.exitNameTag(this)}accept(e){return e.visitNameTag?e.visitNameTag(this):e.visitChildren(this)}},Q=class extends A.ParserRuleContext{TYPE_TAG(){return this.getToken(s.TYPE_TAG,0)}paramName(){return this.getRuleContext(0,ue)}paramTransform(){return this.getRuleContext(0,se)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_paramTag}enterRule(e){e.enterParamTag&&e.enterParamTag(this)}exitRule(e){e.exitParamTag&&e.exitParamTag(this)}accept(e){return e.visitParamTag?e.visitParamTag(this):e.visitChildren(this)}},se=class extends A.ParserRuleContext{TRANSFORM_ARROW(){return this.getToken(s.TRANSFORM_ARROW,0)}transformRule(){return this.getRuleContext(0,ie)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_paramTransform}enterRule(e){e.enterParamTransform&&e.enterParamTransform(this)}exitRule(e){e.exitParamTransform&&e.exitParamTransform(this)}accept(e){return e.visitParamTransform?e.visitParamTransform(this):e.visitChildren(this)}},ie=class extends A.ParserRuleContext{spreadTransform(){return this.tryGetRuleContext(0,ne)}pickTransform(){return this.tryGetRuleContext(0,F)}spreadPickTransform(){return this.tryGetRuleContext(0,ae)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_transformRule}enterRule(e){e.enterTransformRule&&e.enterTransformRule(this)}exitRule(e){e.exitTransformRule&&e.exitTransformRule(this)}accept(e){return e.visitTransformRule?e.visitTransformRule(this):e.visitChildren(this)}},ne=class extends A.ParserRuleContext{OB(){return this.getToken(s.OB,0)}SPREAD(){return this.getToken(s.SPREAD,0)}CB(){return this.getToken(s.CB,0)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_spreadTransform}enterRule(e){e.enterSpreadTransform&&e.enterSpreadTransform(this)}exitRule(e){e.exitSpreadTransform&&e.exitSpreadTransform(this)}accept(e){return e.visitSpreadTransform?e.visitSpreadTransform(this):e.visitChildren(this)}},F=class extends A.ParserRuleContext{OB(){return this.getToken(s.OB,0)}key(e){return e===void 0?this.getRuleContexts(w):this.getRuleContext(e,w)}CB(){return this.getToken(s.CB,0)}COMMA(e){return e===void 0?this.getTokens(s.COMMA):this.getToken(s.COMMA,e)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_pickTransform}enterRule(e){e.enterPickTransform&&e.enterPickTransform(this)}exitRule(e){e.exitPickTransform&&e.exitPickTransform(this)}accept(e){return e.visitPickTransform?e.visitPickTransform(this):e.visitChildren(this)}},ae=class extends A.ParserRuleContext{OB(){return this.getToken(s.OB,0)}pickTransform(){return this.getRuleContext(0,F)}SPREAD(){return this.getToken(s.SPREAD,0)}CB(){return this.getToken(s.CB,0)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_spreadPickTransform}enterRule(e){e.enterSpreadPickTransform&&e.enterSpreadPickTransform(this)}exitRule(e){e.exitSpreadPickTransform&&e.exitSpreadPickTransform(this)}accept(e){return e.visitSpreadPickTransform?e.visitSpreadPickTransform(this):e.visitChildren(this)}},w=class extends A.ParserRuleContext{ID(){return this.getToken(s.ID,0)}C_REQUIRED_MARK(){return this.tryGetToken(s.C_REQUIRED_MARK,0)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_key}enterRule(e){e.enterKey&&e.enterKey(this)}exitRule(e){e.exitKey&&e.exitKey(this)}accept(e){return e.visitKey?e.visitKey(this):e.visitChildren(this)}},he=class extends A.ParserRuleContext{ID(){return this.getToken(s.ID,0)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_queryName}enterRule(e){e.enterQueryName&&e.enterQueryName(this)}exitRule(e){e.exitQueryName&&e.exitQueryName(this)}accept(e){return e.visitQueryName?e.visitQueryName(this):e.visitChildren(this)}},ue=class extends A.ParserRuleContext{ID(){return this.getToken(s.ID,0)}constructor(e,t){super(e,t)}get ruleIndex(){return s.RULE_paramName}enterRule(e){e.enterParamName&&e.enterParamName(this)}exitRule(e){e.exitParamName&&e.exitParamName(this)}accept(e){return e.visitParamName?e.visitParamName(this):e.visitChildren(this)}};var ox=require("antlr4ts/misc/index.js"),T;(function(x){x.Scalar="scalar",x.PickTuple="pick_tuple",x.ArraySpread="array_spread",x.PickArraySpread="pick_array_spread"})(T||(T={}));function H(x){if(!x)throw new Error("Assertion Failed")}function lx({name:x,required:e},t,r,n){let c=t,l=[],h,a=r;if(a)h=`$${a.assignedIndex}`;else{let f=++c;if(h=`$${f}`,a={assignedIndex:f,type:0,name:x,required:e},n){let u=n[x];l.push(u)}}return{bindings:l,replacement:h,nextIndex:c,config:a}}function mx({name:x,required:e},t,r,n){let c=t,l=[],h=r,a=[];h?a=h.assignedIndex:(n?a=n[x].map(m=>(l.push(m),++c)):a=[++c],h={assignedIndex:a,type:1,name:x,required:e});let f="("+a.map(u=>`$${u}`).join(", ")+")";return{bindings:l,replacement:f,nextIndex:c,config:h}}function dx(x,e,t,r,n){let c=t,l=[],h=r||{name:x,type:2,dict:{}},f="("+e.map(({name:u,required:m})=>{if(u in h.dict)return h.dict[u].required=h.dict[u].required||m,`$${h.dict[u].assignedIndex}`;let d=++c;if(h.dict[u]={assignedIndex:d,name:u,required:m,type:0},n){let M=n[x][u];l.push(M)}return`$${d}`}).join(", ")+")";return{bindings:l,replacement:f,nextIndex:c,config:h}}function px(x,e,t,r,n){let c=t,l=[],h=r||{name:x,type:3,dict:{}},a;if(n){let f=n[x];f.length>0?a=f.map(u=>e.map(({name:m})=>(l.push(u[m]),`$${++c}`)).join(", ")).map(u=>`(${u})`).join(", "):a="()"}else a="("+e.map(({name:u,required:m})=>{if(u in h.dict)return`$${h.dict[u].assignedIndex}`;let d=++c;return h.dict[u]={assignedIndex:d,name:u,required:m,type:0},`$${d}`}).join(", ")+")";return{bindings:l,replacement:a,nextIndex:c,config:h}}var ce=(x,e)=>{let t=[],r={},n=0,c=[];for(let h of x.params){let a,f=[],u,m;if(h.selection.type===y.Scalar){let d=r[h.name];m=lx(h,n,d,e)}if(h.selection.type===y.ScalarArray){let d=r[h.name];m=mx(h,n,d,e)}if(h.selection.type===y.Object){let d=r[h.name]||{name:h.name,type:2,dict:{}};m=dx(h.name,h.selection.keys,n,d,e)}if(h.selection.type===y.ObjectArray){let d=r[h.name]||{name:h.name,type:3,dict:{}};m=px(h.name,h.selection.keys,n,d,e)}H(m),{config:u,nextIndex:n,replacement:a,bindings:f}=m,r[h.name]=u,t.push(...f),c.push({a:h.location.a,b:h.location.b,sub:a})}let l=q(x.text,c);return{mapping:e?[]:Object.values(r),query:l,bindings:t}};var oe=(x,e)=>{let t=[],r=[],n=x.params.filter(a=>a.name in x.usedParamSet),c=1,l=[];for(let a of n){if(a.transform.type===T.ArraySpread){let u;if(e)u=e[a.name].map(d=>(t.push(d),`$${c++}`)).join(",");else{let m=c++;r.push({name:a.name,type:1,assignedIndex:m,required:a.required}),u=`$${m}`}a.locs.forEach(m=>l.push({...m,sub:`(${u})`}));continue}if(a.transform.type===T.PickTuple){let u={},m=a.transform.keys.map(({name:d,required:M})=>{let P=c++;if(u[d]={name:d,required:M,type:0,assignedIndex:P},e){let Ze=e[a.name][d];t.push(Ze)}return`$${P}`}).join(",");e||r.push({name:a.name,type:2,dict:u}),a.locs.forEach(d=>l.push({...d,sub:`(${m})`}));continue}if(a.transform.type===T.PickArraySpread){let u;if(e)u=e[a.name].map(d=>(H(a.transform.type===T.PickArraySpread),a.transform.keys.map(({name:P})=>{let ye=d[P];return t.push(ye),`$${c++}`}).join(","))).join("),(");else{let m={};u=a.transform.keys.map(({name:d,required:M})=>{let P=c++;return m[d]={name:d,required:M,type:0,assignedIndex:P},`$${P}`}).join(","),r.push({name:a.name,type:3,dict:m})}a.locs.forEach(m=>l.push({...m,sub:`(${u})`}));continue}let f=c++;if(e){let u=e[a.name];t.push(u)}else r.push({name:a.name,type:0,assignedIndex:f,required:a.required});a.locs.forEach(u=>l.push({...u,sub:`$${f}`}))}let h=q(x.statement,l);return{mapping:r,query:h,bindings:t}};function Rx(x){let e=x[x.length-1];return e==="!"||e==="?"}function je(x){for(let e of x)for(let t in e)if(Rx(t)){let r=t.slice(0,-1);e[r]=e[t],delete e[t]}return x}var K=class{constructor(e){this.query=e,this.run=async(t,r)=>{let{query:n,bindings:c}=ce(this.query,t),l=await r.query(n,c);return je(l.rows)}}},Je=x=>{let{query:e}=Ae(x[0]);return new K(e)},le=class{constructor(e){this.queryIR=e,this.run=async(t,r)=>{let{query:n,bindings:c}=oe(this.queryIR,t),l=await r.query(n,c);return je(l.rows)}}};0&&(module.exports={ParameterTransform,PreparedQuery,TaggedQuery,processSQLQueryIR,processTSQueryAST,sql});
//# sourceMappingURL=index.cjs.map
